{% extends "base.html" %}

{% block title %}è¶…ç´šç®¡ç†è€…å¾Œå°{% endblock %}

{% block content %}
<h1>è¶…ç´šç®¡ç†è€…å¾Œå°</h1>

{% if message %}
  <div class="alert alert-info">{{ message }}</div>
{% endif %}

<!-- (A) åŒ¯å…¥æ¯æ—¥éŠ·å”®æ˜ç´° (è‹¥æœ‰ä½¿ç”¨ ExcelUploadForm ç­‰) -->
<h2>åŒ¯å…¥æ¯æ—¥éŠ·å”®æ˜ç´°</h2>
<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="btn btn-primary">ä¸Šå‚³ä¸¦åŒ¯å…¥</button>
</form>

<hr>

<!-- (B) æœƒå“¡è³‡æ–™ç®¡ç† + æˆç‚ºè¶…ç´šç®¡ç†è€…å‹¾é¸é …ç›® -->
<h2>æœƒå“¡è³‡æ–™ç®¡ç†</h2>
<form method="post">
  {% csrf_token %}
  <!-- é€™å€‹éš±è—æ¬„ä½ç”¨ä¾†å€åˆ†æ˜¯ã€Œæ›´æ–°è¶…ç´šç®¡ç†è€…ã€çš„å‹•ä½œ -->
  <input type="hidden" name="action" value="update_superusers">

  <table class="table table-striped">
    <thead>
      <tr>
        <th>ä½¿ç”¨è€…åç¨±</th>
        <th>Email</th>
        <th>æ˜¯å¦è¶…ç´šç®¡ç†è€…</th>
        <th>æˆç‚ºè¶…ç´šç®¡ç†è€…</th>
        <th>æ“ä½œ</th>
      </tr>
    </thead>
    <tbody>
      {% for member in members %}
      <tr>
        <td>{{ member.username }}</td>
        <td>{{ member.email }}</td>
        <td>{{ member.is_superuser }}</td>
        <td>
          <!-- è‹¥è©²ä½¿ç”¨è€…ç›®å‰æ˜¯è¶…ç´šç®¡ç†è€…ï¼Œå°±å‹¾é¸ -->
          <input type="checkbox" name="superusers" value="{{ member.id }}"
                 {% if member.is_superuser %}checked{% endif %}>
        </td>
        <td>
          <!-- é€£çµåˆ°è‡ªè¨‚çš„ä½¿ç”¨è€…ç·¨è¼¯é é¢ -->
          <a href="{% url 'super_admin_edit_user' member.id %}" class="btn btn-sm btn-secondary">ç·¨è¼¯</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <button type="submit" class="btn btn-primary">æ›´æ–°è¶…ç´šç®¡ç†è€…</button>
</form>

<!-- (C) æ‰‹å‹•åŒæ­¥ Google Sheets æŒ‰éˆ• -->
<hr>
<form method="post">
    {% csrf_token %}
    <button type="submit" name="sync_google_sheets" class="btn btn-primary">ğŸ”„ æ‰‹å‹•åŒæ­¥ Google Sheets</button>
</form>

{% if message %}
<p>{{ message }}</p>
{% endif %}

<!-- (D) è¶…ç´šç®¡ç†è€…ç™»å‡ºæŒ‰éˆ• -->
<form method="post" action="{% url 'logout' %}">
    {% csrf_token %}
    <button type="submit" class="btn btn-danger">ğŸšª ç™»å‡º</button>
</form>
<p>{{ message }}</p>

{% endblock %}
